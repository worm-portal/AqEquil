Module AqEquil.MassTransfer
===========================

Functions
---------

    
`join_mixes(m1, m2)`
:   Join the results of two mixes, m1 and m2, so that results extend from
    1:0 to 0:1 m1:m2.
    
    Parameters
    ----------
    m1, m2 : objects of class Mass_Transfer
        The mass transfer results of two mixing calculations
    
    Returns
    ----------
    An object of class `Mass_Transfer` with results joined for plotting.

    
`react(speciation, reaction_setup, chain_mt=False, delete_generated_folders=False, hide_traceback=True, data1_override=None, format_element_names=True, eq36da=None, eq36co=None, verbose=1)`
:   Calculate how speciated water reacts with minerals and/or gases.
    
    Parameters
    ----------
    speciation : Speciation object
        The output of a speciation calculation produced by the
        AqEquil.speciate function.
    
    reaction_setup : str or Prepare_Reaction object
        Defines how the reaction is to be set up. There are two ways to set up
        a reaction. The first way is to prepare the reaction with
        `Prepare_Reaction`. The second way is to prepare the first half of an
        EQ6 6i file (the part without the contents of the pickup file) and then
        pass the filename to `reaction_setup`.
    
    chain_mt : bool, default False
        Is the speciation the result of another mass transfer calculation?
        Choosing True will allow mass transfer calculations to be chained
        together.
    
    delete_generated_folders : bool, default False
        Delete the 'rxn_6i', 'rxn_6o', 'rxn_6p', and 'eq6_extra_out' folders
        containing raw EQ6 input, output, and pickup files once the
        reaction calculation is complete?
    
    hide_traceback : bool, default True
        Hide traceback message when encountering errors handled by this class?
        When True, error messages handled by this class will be short and to
        the point.
    
    data1_override : str, optional
        The three letter code of a data1 file used to override the thermodynamic
        database used to speciate the sample(s). This is useful for chaining
        the results of one mass transfer calculation into another while
        simultaneously changing the temperature and pressure regime of the
        new system. See the description for the `chain_mt` parameter for more
        about chaining.
    
    format_element_names : bool, default True
        Format the chemical symbols of redox-isolated elements generated when
        elements are supplied to the `suppress_redox` parameter of
        `AqEquil.speciate`? Context: when elements are redox-isolated, new
        elements are designated representing different oxidations states in
        order to prevent redox reactions from occuring during calculations. The
        names of these elements appear like "Fejiip", where the first one or two
        letters represent the element (e.g. "Fe"), "j" denotes that the
        chemical symbol is finished, followed by roman numerals representing the
        magnitude of the charge (e.g., "ii" representing 2), finally followed by
        a letter that denotes the sign of the charge (e.g., "p" for positive).
        By setting this parameter to True, the element "Fejiip" will be
        converted into a more readable form, "Fe+2", in all figures and tables
        generated from calculation results. It may be useful to set this
        parameter to False if you are supplying your own data0 file containing
        custom pseudoelements that do not follow the convention used by AqEquil.
    
    eq36da : str, defaults to path given by the environment variable EQ36DA
        Path to directory where data1 files are stored. 
        
    eq36co : str, defaults to path given by the environment variable EQ36CO
        Path to directory where EQ3 executables are stored.
    
    Returns
    ----------
    An object of class `Speciation` modified with the results of the reaction
    (if a thermodynamic database formatted as a WORM-style CSV was used during
    speciation) or an unmodified speciation object (if a data0 or data1 file
    was used during speciation).

Classes
-------

`Gas(gas_name='None', gas_moles=0, gas_log_fugacity=0)`
:   Class used to define gases for `Prepare_Reaction`.
    
    Parameters
    ----------
    gas_name : str, default "None"
        Name of the gas.
    
    gas_moles : float, default 0
        Moles of gas.
    
    gas_log_fugacity : float, default 0
        The log10 fugacity of the gas.

`Mass_Transfer(six_o_file, thermo=None, tab_name=None, format_element_names=True, hide_traceback=True, verbose=1)`
:   Class containing functions to facilitate mass transfer and reaction path
    calculations and visualize results.
    
    Parameters
    ----------
    six_o_file : str
        Path name of the '6o' output file generated by EQ6.
    
    thermo : an object of class Thermodata
        The subclass containing thermodynamic data in a Speciation object.
    
    thermodata_csv : str
        Path name of the WORM-styled thermodynamic database CSV used in the EQ6
        calculation.
    
    tab_name : str
        Path name of the TAB file generated by EQ6.
    
    format_element_names : bool, default True
        Format the chemical symbols of redox-isolated elements generated when
        elements are supplied to the `suppress_redox` parameter of
        `AqEquil.speciate`? Context: when elements are redox-isolated, new
        elements are designated representing different oxidations states in
        order to prevent redox reactions from occuring during calculations. The
        names of these elements appear like "Fejiip", where the first one or two
        letters represent the element (e.g. "Fe"), "j" denotes that the
        chemical symbol is finished, followed by roman numerals representing the
        magnitude of the charge (e.g., "ii" representing 2), finally followed by
        a letter that denotes the sign of the charge (e.g., "p" for positive).
        By setting this parameter to True, the element "Fejiip" will be
        converted into a more readable form, "Fe+2", in all figures and tables
        generated from calculation results. It may be useful to set this
        parameter to False if you are supplying your own data0 file containing
        custom pseudoelements that do not follow the convention used by AqEquil.
    
    hide_traceback : bool, default True
        Hide traceback message when encountering errors handled by this class?
        When True, error messages handled by this class will be short and to
        the point.

    ### Static methods

    `process_tab(tab_name, thermodata_csv)`
    :   Process a TAB file (from EQ6) into a dictionary of Pandas dataframes.
        
        Parameters
        ----------
        tab_name : str
            Path name of the TAB file generated by EQ6.
        
        thermodata_csv : str or Pandas dataframe
            Path name of the WORM-styled thermodynamic database CSV used in the
            EQ6 calculation. Alternately, the thermodynamic database itself as a
            Pandas dataframe itself.
        
        Returns
        -------
        tab : a dict of Pandas dataframes
            A dictionary of dataframes representing tables mined from the TAB
            file.

    ### Methods

    `mine_6o_table(self, table_start='--- Distribution of Aqueous Solute Species ---', table_stop='Species with molalities less than', ignore=['', 'Species', '---'], col_index=-1)`
    :   Mine a table in a '6o' EQ6 output file and consolidate results into a
        dataframe.
        
        Parameters
        ----------
        table_start : str
            A unique string that indicates the start of the table.
        
        table_stop : str, optional
            A unique string that indicates the end of the table.
        
        ignore : list of str
            A list of strings representing lines to ignore when mining a table.
            For example, it is prudent to ignore blank lines, or lines
            containing the table column headers.
            A line will be skipped if line.strip().split(' ')[0] matches any
            of the strings in the given list.
        
        col_index : int, default -1
            Integer representing the index of the table column to be mined.
            The default is -1, which is the last column in the table.
            
        Returns
        -------
        df : Pandas dataframe
            A dataframe with rows of the extent of reaction (Xi), and columns
            containing the values of chemical species mined from the file.

    `plot_aqueous_species(self, plot_basis=False, plot_species=None, x_type='logxi', y_type='log activity', initially_visible=None, show_legend=True, charge_sign_at_end=False, plot_width=4, plot_height=3, ppi=122, xlim=None, ylim=None, save_as=None, save_format=None, save_scale=1)`
    :   Generate a line plot of the log activities of aqueous species as a
        function of the log of the extent of reaction (log Xi) or some other
        variable.
        
        Parameters
        ----------
        plot_basis : bool, default False
            Plot basis species only?
        
        plot_species : list of str, optional
            A list of aqueous species to plot. If undefined, every species at
            will be plotted at once.
        
        x_type : str, default "logxi"
            Variable to appear on the x-axis. Can be "logxi", "xi",
            "temperature", "pressure", "pH", "pmH", "logfO2", "Eh", "pe", or
            "aw".
        
        y_type : str, default 'log activity'
            The variable to plot on the y-axis. Can be either 'log activity',
            'molality', or 'log molality'.
        
        initially_visible : list of str, optional
            A list of aqueous species that will be visible on the plot
            initially. All other species will be hidden, but can still be
            toggled back on in the legend.
        
        show_legend : bool, default True
            Show the legend?
        
        charge_sign_at_end : bool, default False
            Display charge with sign after the number (e.g. SO4 2-)?
        
        plot_width, plot_height : numeric, default 4 by 3
            Width and height of the plot, in inches. Size of interactive plots
            is also determined by pixels per inch, set by the parameter `ppi`.
            
        ppi : numeric, default 122
            Pixels per inch. Along with `plot_width` and `plot_height`,
            determines the size of interactive plots.
            
        xlim, ylim : list of two numeric values, optional
            Minimum and maximum value of the x-axis and y-axis, respectively.
            
        save_as : str, optional
            Provide a filename to save this figure. Filetype of saved figure is
            determined by `save_format`.
            Note: interactive plots can be saved by clicking the 'Download plot'
            button in the plot's toolbar.
        
        save_format : str, default "png"
            Desired format of saved or downloaded figure. Can be 'png', 'jpg',
            'jpeg', 'webp', 'svg', 'pdf', 'eps', 'json', or 'html'. If 'html',
            an interactive plot will be saved. Only 'png', 'svg', 'jpeg',
            and 'webp' can be downloaded with the 'download as' button in the
            toolbar of an interactive plot.
        
        save_scale : numeric, default 1
            Multiply title/legend/axis/canvas sizes by this factor when saving
            the figure.
            
        Returns
        -------
        fig : Plotly figure object
            A line plot.

    `plot_elements(self, plot_elements=None, units='molality', log=True, x_type='logxi', plot_width=4, plot_height=3, ppi=122, ylim=None, show_legend=True, charge_sign_at_end=False, save_as=None, save_format=None, save_scale=1)`
    :   Generate a line plot of the log activities of aqueous species as a
        function of the log of the extent of reaction (log Xi).
        
        Parameters
        ----------
        plot_elements : list of str, optional
            A list of elements to plot. If undefined, every element will be
            plotted at once.
        
        units : str, default "molality"
            Units of elemental abundance to plot. Can be "molality" or "ppm".
        
        log : bool, default True
            Display elemental abundances in log scale?
        
        plot_width, plot_height : numeric, default 4 by 3
            Width and height of the plot, in inches. Size of interactive plots
            is also determined by pixels per inch, set by the parameter `ppi`.
            
        ppi : numeric, default 122
            Pixels per inch. Along with `plot_width` and `plot_height`,
            determines the size of interactive plots.
            
        ylim : list of two numeric values, optional
            Minimum and maximum value of the y-axis.
            
        show_legend : bool, default True
            Show the legend?
            
        charge_sign_at_end : bool, default False
            Display charge with sign after the number (e.g. SO4 2-)?
            
        save_as : str, optional
            Provide a filename to save this figure. Filetype of saved figure is
            determined by `save_format`.
            Note: interactive plots can be saved by clicking the 'Download plot'
            button in the plot's toolbar.
        
        save_format : str, default "png"
            Desired format of saved or downloaded figure. Can be 'png', 'jpg',
            'jpeg', 'webp', 'svg', 'pdf', 'eps', 'json', or 'html'. If 'html',
            an interactive plot will be saved. Only 'png', 'svg', 'jpeg',
            and 'webp' can be downloaded with the 'download as' button in the
            toolbar of an interactive plot.
        
        save_scale : numeric, default 1
            Multiply title/legend/axis/canvas sizes by this factor when saving
            the figure.
            
        Returns
        -------
        fig : Plotly figure object
            A line plot.

    `plot_energy(self, species, stoich, divisor=1, x_type='logxi', y_type='A', y_units='kcal', show_zero_line=False, limiting=None, xlab=None, ylab=None, title=None, charge_sign_at_end=False, log_y=False, plot_width=4, plot_height=3, ppi=122, xlim=None, ylim=None, df_out=False, save_as=None, save_format=None, save_scale=1, print_logK_messages=False)`
    :   Generate a line plot of the energy profile for a reaction as a
        function of the log of the extent of reaction (log Xi) or some other
        variable.
        
        Parameters
        ----------
        species : list of str
            A list of species that match the order of the stoichiometric
            reaction coefficients in the `stoich` parameter.
        
        stoich : list of numeric
            A list of stoichiometric reaction coefficients that match the order
            of the species in the `species` parameter.
        
        divisor : float, default 1
            Divide all values in the energy profile by this number. Useful for
            calculating energy per electron transferred or similar.
        
        x_type : str, default "logxi"
            Variable to appear on the x-axis. Can be "logxi", "xi",
            "temperature", "pressure", "pH", "pmH", "logfO2", "Eh", "pe", or
            "aw".
        
        y_type : str, default 'A'
            The variable to plot on the y-axis. Can be either 'A' (for chemical
            affinity), 'G' (for Gibbs free energy, ΔG), 'logK' (for the log
            of the equilibrium constant), 'logQ' (for the log of the reaction
            quotient), or 'E' for energy supply.
        
        y_units : str, default 'kcal'
            The unit that energy will be reported in (per mol for G and A, or
            per kg fluid for energy supply, or unitless for logK and logQ).
            Can be 'kcal', 'cal', 'J', or 'kJ'.
        
        show_zero_line : bool, default False
            If True, displays a dotted line where affinity or ΔG equals 0 (at
            equilibrium).
        
        limiting : str, optional
            Name of the species to act as the limiting reactant when calculating
            energy supply. If this parameter is left undefined, then a
            limiting reactant will be chosen automatically based on
            concentration and stoichiometry. This parameter is ignored unless
            `y_type` is set to 'E' (energy supply).
        
        xlab, ylab : str, optional
            Custom x and y axis labels.
        
        title : str, optional
            Title of the plot to display.
        
        charge_sign_at_end : bool, default False
            Display charge with sign after the number (e.g. SO4 2- instead of
            SO4-2) in species names when the reaction is displayed in the plot
            title?
        
        plot_width, plot_height : numeric, default 4 by 3
            Width and height of the plot, in inches. Size of interactive plots
            is also determined by pixels per inch, set by the parameter `ppi`.
            
        ppi : numeric, default 122
            Pixels per inch. Along with `plot_width` and `plot_height`,
            determines the size of interactive plots.
            
        xlim, ylim : list of two numeric values, optional
            Minimum and maximum value of the x-axis and y-axis, respectively.
            
        df_out = bool, default False
            Return a pandas dataframe in addition to a figure?
            
        save_as : str, optional
            Provide a filename to save this figure. Filetype of saved figure is
            determined by `save_format`.
            Note: interactive plots can be saved by clicking the 'Download plot'
            button in the plot's toolbar.
        
        save_format : str, default "png"
            Desired format of saved or downloaded figure. Can be 'png', 'jpg',
            'jpeg', 'webp', 'svg', 'pdf', 'eps', 'json', or 'html'. If 'html',
            an interactive plot will be saved. Only 'png', 'svg', 'jpeg',
            and 'webp' can be downloaded with the 'download as' button in the
            toolbar of an interactive plot.
        
        save_scale : numeric, default 1
            Multiply title/legend/axis/canvas sizes by this factor when saving
            the figure.
            
        print_logK_messages : bool, default False
            Print pyCHNOSZ messages while the logK of the reaction is
            calculated?
            
        Returns
        -------
        fig : Plotly figure object, optionally a Pandas Dataframe
            A line plot. If `df_out` is True, also returns a dataframe.

    `plot_mass_contribution(self, *args, x_type='xi', x_decimals=3, track_steps=True, keep_xi_order=False, **kwargs)`
    :   Generate a bar plot of mass contributions (in mole percent) of aqueous
        species formed as a function of reaction progress Xi or some other
        variable.
        
        Parameters
        ----------
        *args : iterable
            Arguments to be passed to `Speciation.plot_mass_contribution`.
        
        x_type : str, default "xi"
            Variable to appear on the x-axis. Can be "logxi", "xi",
            "temperature", "pressure", "pH", "pmH", "logfO2", "Eh", "pe", or
            "aw".
        
        x_decimals : int
            Number of decimals to display in the numeric values of the x-axis
            variable defined by `x_type`.
        
        track_steps : bool, default True
            Show reported xi steps on x-axis ticks? Useful for plotting as a
            function of an x-axis variable that can be out-of-order, like
            Eh or temperature. This parameter will become True automatically
            if it will prevent column stacking (which happens if there are
            duplicate x-axis values).
        
        **kargs : dict
            Keyword arguments to be passed to `Speciation.plot_mass_contribution`.
            
        Returns
        -------
        fig : Plotly figure object
            A mass contribution bar plot.

    `plot_mineral_saturation(self, solid_solutions=False, plot_minerals=None, x_type='logxi', y_type='affinity', log_y=True, df_out=False, markers=False, title=None, plot_width=4, plot_height=3, ppi=122, ylim=None, show_legend=True, save_as=None, save_format=None, save_scale=1)`
    :   Generate a line plot of the saturation indices of minerals or solid
        solutions as a function of the log of the extent of reaction (log Xi) or
        some other variable.
        
        Parameters
        ----------
        plot_minerals : list, optional
            List of minerals to plot. Useful for isolating one or more
            minerals.
            
        x_type : str, default "logxi"
            Variable to appear on the x-axis. Can be "logxi", "xi",
            "temperature", "pressure", "pH", "pmH", "logfO2", "Eh", "pe", or
            "aw".
            
        y_type : str, default 'affinity'
            The variable to plot on the y-axis. Can be either 'affinity'
            or 'logQ/K'.
            
        df_out : bool, default False
            Should a dataframe of values also be returned? For example, if
            `y_type` is set to 'volume', should a table of mineral volumes be
            returned?
            
        markers : bool, default True
            Add circular markers to lines to indicate calculation steps?
        
        title : str, optional
            Used to customize the title of the plot.
            
        plot_width, plot_height : numeric, default 4 by 3
            Width and height of the plot, in inches. Size of interactive plots
            is also determined by pixels per inch, set by the parameter `ppi`.
            
        ppi : numeric, default 122
            Pixels per inch. Along with `plot_width` and `plot_height`,
            determines the size of interactive plots.
            
        ylim : list of two numeric values, optional
            Minimum and maximum value of the y-axis.
            
        show_legend : bool, default True
            Show the legend?
            
        save_as : str, optional
            Provide a filename to save this figure. Filetype of saved figure is
            determined by `save_format`.
            Note: interactive plots can be saved by clicking the 'Download plot'
            button in the plot's toolbar.
        
        save_format : str, default "png"
            Desired format of saved or downloaded figure. Can be 'png', 'jpg',
            'jpeg', 'webp', 'svg', 'pdf', 'eps', 'json', or 'html'. If 'html',
            an interactive plot will be saved. Only 'png', 'svg', 'jpeg',
            and 'webp' can be downloaded with the 'download as' button in the
            toolbar of an interactive plot.
        
        save_scale : numeric, default 1
            Multiply title/legend/axis/canvas sizes by this factor when saving
            the figure.
            
        Returns
        -------
        fig : Plotly figure object
            A line plot.
            
        df : a Pandas dataframe
            A dataframe is only returned if `df_out` is set to True (it is
            set to False by default).

    `plot_pH(self, x_type='logxi', show_neutrality=True, title=None, plot_width=4, plot_height=3, ppi=122, ylim=None, save_as=None, save_format=None, save_scale=1)`
    :   Generate a line plot of pH as a function of the log of the extent of
        reaction (log Xi) or some other variable.
        
        Parameters
        ----------
        x_type : str, default "logxi"
            Variable to appear on the x-axis. Can be "logxi", "xi",
            "temperature", "pressure", "pH", "pmH", "logfO2", "Eh", "pe", or
            "aw".
        
        show_neutrality : bool, default True,
            Display a reference line representing neutral pH? Setting this
            option to True requires a thermodynamic database in a WORM-style CSV
            format, e.g., 'wrm_data.csv'.
        
        title : str
            Title of the plot to display.
        
        plot_width, plot_height : numeric, default 4 by 3
            Width and height of the plot, in inches. Size of interactive plots
            is also determined by pixels per inch, set by the parameter `ppi`.
            
        ppi : numeric, default 122
            Pixels per inch. Along with `plot_width` and `plot_height`,
            determines the size of interactive plots.
            
        ylim : list of two numeric values, optional
            Minimum and maximum value of the y-axis.
            
        save_as : str, optional
            Provide a filename to save this figure. Filetype of saved figure is
            determined by `save_format`.
            Note: interactive plots can be saved by clicking the 'Download plot'
            button in the plot's toolbar.
        
        save_format : str, default "png"
            Desired format of saved or downloaded figure. Can be 'png', 'jpg',
            'jpeg', 'webp', 'svg', 'pdf', 'eps', 'json', or 'html'. If 'html',
            an interactive plot will be saved. Only 'png', 'svg', 'jpeg',
            and 'webp' can be downloaded with the 'download as' button in the
            toolbar of an interactive plot.
        
        save_scale : numeric, default 1
            Multiply title/legend/axis/canvas sizes by this factor when saving
            the figure.
            
        Returns
        -------
        fig : Plotly figure object
            A line plot.

    `plot_product_minerals(self, show_reactant_minerals=False, plot_minerals=None, x_type='logxi', y_type='mole', log_y=True, df_out=False, markers=False, plot_width=4, plot_height=3, ppi=122, ylim=None, show_legend=True, save_as=None, save_format=None, save_scale=1)`
    :   Generate a line plot of the log moles of product minerals as a
        function of the log of the extent of reaction (log Xi) or some other
        variable.
        
        Parameters
        ----------
        show_reactant_minerals : bool, default False
            Include log moles of reactant minerals?
            
        plot_minerals : list, optional
            List of minerals to plot. Useful for isolating one or more
            minerals.
            
        x_type : str, default "logxi"
            Variable to appear on the x-axis. Can be "logxi", "xi",
            "temperature", "pressure", "pH", "pmH", "logfO2", "Eh", "pe", or
            "aw".
            
        y_type : str, default 'mole'
            The variable to plot on the y-axis. Can be either 'mole' (for moles
            of minerals), 'mass' (for masses of minerals), or 'volume' (for
            volumes of minerals).
        
        log_y : bool, default True
            Should the y-axis be logarithmic?
            
        df_out : bool, default False
            Should a dataframe of values also be returned? For example, if
            `y_type` is set to 'volume', should a table of mineral volumes be
            returned?
            
        markers : bool, default True
            Add circular markers to lines to indicate calculation steps?
            
        plot_width, plot_height : numeric, default 4 by 3
            Width and height of the plot, in inches. Size of interactive plots
            is also determined by pixels per inch, set by the parameter `ppi`.
            
        ppi : numeric, default 122
            Pixels per inch. Along with `plot_width` and `plot_height`,
            determines the size of interactive plots.
            
        ylim : list of two numeric values, optional
            Minimum and maximum value of the y-axis.
            
        show_legend : bool, default True
            Show the legend?
            
        save_as : str, optional
            Provide a filename to save this figure. Filetype of saved figure is
            determined by `save_format`.
            Note: interactive plots can be saved by clicking the 'Download plot'
            button in the plot's toolbar.
        
        save_format : str, default "png"
            Desired format of saved or downloaded figure. Can be 'png', 'jpg',
            'jpeg', 'webp', 'svg', 'pdf', 'eps', 'json', or 'html'. If 'html',
            an interactive plot will be saved. Only 'png', 'svg', 'jpeg',
            and 'webp' can be downloaded with the 'download as' button in the
            toolbar of an interactive plot.
        
        save_scale : numeric, default 1
            Multiply title/legend/axis/canvas sizes by this factor when saving
            the figure.
            
        Returns
        -------
        fig : Plotly figure object
            A line plot.
            
        df : a Pandas dataframe
            A dataframe is only returned if `df_out` is set to True (it is
            set to False by default).

    `plot_reaction_paths(self, xyb=None, path_margin=0.25, flip_xy=False, show_annotation=True, annotation_coords=[0, 0], show_nonparticipating_mineral_lines=False, minerals_to_show=[], calculate_projected_points=True, path_line_type='markers+lines', path_line_color='red', path_point_fill_color='red', path_point_line_color='red', projected_point_fill_color='white', projected_point_line_color='red', h_line_color='black', v_line_color='black', d_line_color='black', res=300, plot_width=4, plot_height=3, ppi=122, borders=0, save_as=None, save_format=None, save_scale=1, colormap='bw')`
    :   Create interactive plots of reaction paths in geochemical variable
        space.
        
        Parameters
        ----------
        xyb : list of three str, default None
            By default, this function will plot reaction paths in all possible
            dimensions.
            
            Optionally, if you want to produce only a specific plot,
            you can provide a list containing the basis species to be used for
            the x-axis and y-axis, followed by the basis species used for
            balance. For example, ["Fe+2", "Fe+3", "Mg+2"] will have the log
            activity of Fe+2 on the x-axis, the log activity of Fe+3 on the
            y-axis, and will be balanced on Mg+2.
        
        path_margin : float, default 0.25
            Controls the spacing between the reaction path and the plot axes.
            Increasing this value increases the spacing.
        
        flip_xy : bool, default False
            Transpose the plot so the x and y variables switch axes?
        
        show_annotation : bool, default True
            Show annotation in the bottom left of the figure? The annotation
            includes the species used for balance, the temperature, and
            the pressure.
        
        annotation_coords : list, default [0,0]
            List of two numeric values representing the X and Y coordinates of
            the annotation, where 0,0 is the bottom left, 0.5,0 is the bottom
            center, 1,0 is the bottom right, 1,1 is the top right, and so on.
            The annotation includes the species used for balance, the
            temperature and the pressure.
        
        show_nonparticipating_mineral_lines : bool, default False
            Depict lines for minerals even if those minerals do not participate
            in the reaction? This does not affect the mineral field of the
            diagram, only the mineral planes denoted as lines.
        
        path_line_type : str, default "markers+lines"
            Reaction path line type. Can be either "markers+lines", "lines", or
            "markers".
        
        path_line_color, str, default "black"
            Color of reaction path line.
        
        path_point_fill_color : str, default "black"
            Fill color of non-projected points along the reaction path. The
            fill color of projected points is handled by
            `projected_point_fill_color`.
        
        path_point_line_color : str, default "black"
            Color of the outlines of non-projected points along the reaction
            path. The outline color of projected points is handled by
            `projected_point_line_color`.
        
        projected_point_fill_color : str, default "white"
            Fill color of projected points along the reaction path. The
            fill color of non-projected points is handled by
            `path_point_fill_color`.
        
        projected_point_line_color : str, default "black"
            Color of the outlines of projected points along the reaction path.
            The outline color of non-projected points is handled by
            `path_point_line_color`.
            
        h_line_color : str, default "black"
            Color of horizontal lines representing minerals.
        
        v_line_color : str, default "black"
            Color of vertical lines representing minerals.
        
        d_line_color : str, default "black"
            Color of diagonal lines representing minerals.
        
        res : int, default 300
            Resolution, or number of calculations along each axis, for mineral
            stability fields. A lower number will be faster but will make appear
            boundaries blockier. A higher number takes longer to calculate, but
            will result in smoother boundaries.
        
        plot_width, plot_height : numeric, default 4 by 3
            Width and height of the plot, in inches.
        
        ppi : numeric, default 122
            Pixels per inch. Along with `plot_width` and `plot_height`,
            determines the size of interactive plots.
        
        borders : float, default 0
            Thickness of black lines forming boundaries between mineral
            stability regions. No lines appear if equal to 0.
        
        save_as : str, optional
            Provide a filename to save this figure. Filetype of saved figure is
            determined by `save_format`.
            Note: interactive plots can be saved by clicking the 'Download plot'
            button in the plot's toolbar.
        
        save_format : str, default "png"
            Desired format of saved or downloaded figure. Can be 'png', 'jpg',
            'jpeg', 'webp', 'svg', 'pdf', 'eps', 'json', or 'html'. If 'html',
            an interactive plot will be saved. Only 'png', 'svg', 'jpeg',
            and 'webp' can be downloaded with the 'download as' button in the
            toolbar of an interactive plot.
        
        save_scale : numeric, default 1
            Multiply title/legend/axis/canvas sizes by this factor when saving
            the figure.
        
        colormap : str, default "bw"
            Name of the colormap to color the scatterpoints. Accepts "bw"
            or names of matplotlib colormaps. If set to "bw", the plot will be
            set to black and white, except for the reaction path line itself.
            The colors of the reaction path line and its points are controlled
            by `path_line_color`, `path_point_fill_color`,
            `path_point_line_color`, `projected_point_fill_color`,
            and `projected_point_line_color`.
        
        Returns
        -------
        fig_list : a list of Plotly figure objects
            A list of interactive Plotly figures. If xyb equals None
            (the default), then the list will contain figures representing all
            combinations of geochemical variables. Optionally, if xyb is
            specified, fig_list will only contain the single figure of interest.

    `print_tabs(self)`
    :   Print the names of tables contained in a tab file processed by the
        the Mass_Transfer class.

`Mixing_Fluid(speciation, sample_name, amount_remaining=1, amount_destroyed=0, molar_volume=1, mass_ratio=1, hide_traceback=True)`
:   Class used to define the fluid to be mixed with other fluids in
    `Prepare_Reaction`.
    
    Parameters
    ----------
    speciation : object of class Speciation
        The speciation object containing the fluid to be mixed.
    
    sample_name : str
        The name of the fluid sample that will be mixed with all other
        speciated fluids.
    
    amount_remaining : float, default 1
        Number of moles of the fluid to be mixed with all others.
    
    amount_destroyed : float, default 0
        Number of moles of the mixing fluid that has been destroyed.
    
    molar_volume : float, default 1
        Molar volume of the mixing fluid, in moles/cm3.
    
    mass_ratio : float, default 1
        Ratio of mass of the mixing fluid to all other fluids.
    
    hide_traceback : bool, default True
        Hide traceback message when encountering errors handled by this
        class? When True, error messages handled by this class will be short
        and to the point.

`Prepare_Reaction(reactants, gases=[], t_option=None, t_value_1=None, t_value_2=None, t_value_3=None, p_option=0, p_value_1=None, p_value_2=0, xi_range=[0, 1], time_range=[0, 1e+38], pH_range=[-1e+38, 1e+38], Eh_range=[-1e+38, 1e+38], fO2_range=[-1e+38, 1e+38], aw_range=[-1e+38, 1e+38], max_n_steps=900, xi_print_int=1, log_xi_print_int=1, time_print_int=1e+38, log_time_print_int=1e+38, pH_print_interval=1e+38, Eh_print_interval=1e+38, logfO2_print_interval=1e+38, aw_print_interval=1e+38, n_steps_print_interval=100, physical_system_model='closed', kinetic_mode='arbitrary', phase_boundary_search=0, permit_solid_solutions=False, clear_es_solids_read=False, clear_es_solids_initial=False, clear_es_solids_end=False, clear_prs_solids_read=False, clear_prs_solids_end=False, auto_basis_switching_pre_NR=False, auto_basis_switching_post_NR=False, calc_mode_selection=0, ODE_corrector_mode=0, mineral_suppression_option='None', write_tab=-1, fluid_mixing_setup=False, max_finite_difference_order=6, beta_convergence_tolerance=0, del_convergence_tolerance=0, max_n_NR_iter=500, search_find_convergeance_tolerance=0, saturation_tolerance=0, max_n_phase_assemblage_tries=0, zero_order_step_size=0, max_interval_in_xi_between_PRS_transfers=0, filename=None, hide_traceback=True)`
:   Class used to set the parameters of a reaction between the results of a
    speciation calculation and minerals, gases, etc.
    
    Parameters
    ----------
    reactants : list
        List of reactants defined by the 'Reactant' class. Can be an empty
        list if no reactants are desired.
         
    gases : list, default []
        List of gases defined by the 'Gas' class. Can be an empty
        list if no gases are desired.
     
    t_option : int, default 0
        Desired option for handling temperature of the reaction. Valid
        choices include:
        
        - 0 for constant temperature
        - 1 for linear tracking in Xi
        - 2 for linear tracking in time
        
        Fluid mixing tracking is not yet supported.
     
    t_value_1, t_value_2, t_value_3 : default None, 0, 0, respectively
        By default, the temperature of samples in the speciation
        calculation will be used, so the user does not need to specify
        temperature values here. However, if a user wishes, temperature
        values can be defined here that will be applied to all samples in
        the speciation. Note that doing so may result in incongruous
        results. That said, the values specified here depend on which
        option is selected for `t_option`:
        
        - If 't_option' is 0, then t_value_1 is the value of the constant
        temperature (in degrees C), and t_value_2 and t_value_3 are ignored.
        - If 't_option' is 1, then t_value_1 is the base value
        temperature (in degrees C), t_value_2 is the derivative, and
        t_value_3 is ignored.
        - If 't_option' is 2, then t_value_1 is the base value
        temperature (in degrees C), t_value_2 is the derivative, and
        t_value_3 is ignored.
     
    p_option : int, default 0
        Desired option for handling pressure of the reaction. Valid
        choices include:
        
        - 0 to follow the data file reference pressure curve
        - 1 to follow the 1.013-bar/steam-saturation curve
        - 2 for constant pressure
        - 3 for linear tracking in Xi
        - 4 for linear tracking in time
    
    p_value_1, p_value_2 : float default None, 0
        Values assigned to desired `p_option`.
        
        - If `p_option` is 0 or 1, p_value_1 and p_value_2 are ignored.
        - If `p_option` is 2, p_value_1 represents a constant pressure,
        in bars, and p_value_2 is ignored.
        - If `p_option` is 3 or 4, p_value_1 represents the base pressure
        value, in bars, and p_value_2 is the derivative.
     
    xi_range : list of two float, default [0, 1]
        A list containing the starting and maximum value of Xi,
        respectively.
     
    time_range : list of two float, default [0, 1e38]
        A list containing the starting and maximum time, respectively.
     
    pH_range : list of two float, default [-1e38, 1e38]
        A list containing the minimum and maximum values of pH.
     
    Eh_range : list of two float, default [-1e38, 1e38]
        A list containing the minimum and maximum values of Eh.
     
    fO2_range : list of two float, default [-1e38, 1e38]
        A list containing the minimum and maximum values of the fugacity
        of oxygen, fO2.
     
    aw_range : list of two float, default [-1e38, 1e38]
        A list containing the minimum and maximum values of water activity.
     
    max_n_steps : int, default 900
        Maximum number of steps of Xi allowed.
     
    xi_print_int : int, default 1
        Xi print interval.
     
    log_xi_print_int : int, default 1
        Log Xi print interval.
     
    time_print_int : int, default 1e38
        Time print interval.
     
    log_time_print_int : int, default 1e38
        Log time print interval.
     
    pH_print_interval : int, default 1e38
        pH print interval.
     
    Eh_print_interval : int, default 1e38
        Eh (v) print interval.
     
    logfO2_print_interval : int, default 1e38
        Log fO2 print interval.
     
    aw_print_interval : int, default 1e38
        Activity of water (aw) print interval.
     
    n_steps_print_interval : int, default 100
        Steps print interval.
    
    physical_system_model : str, default "closed"
        Selection for the physical system model. Valid options include:
        
        - "closed"
        - "titration"
        - "fluid-centered flow-through open"
    
    kinetic_mode : str, default "arbitrary"
        Selection for kinetic mode. Valid options include:
        - "arbitrary" for arbitrary kinetics, reaction progress mode
        - "true" for true kinetics, reaction progress/time mode 
     
    phase_boundary_search : int, default 0
        Selection for phase boundary searches. Valid options include:
        
        - 0 to search for phase boundaries and constrain the step size to
        match.
        - 1 to search for phase boundaries and print their locations.
        - 2 to not search for phase boundaries.
    
    permit_solid_solutions : bool, default False
        Permit solid solutions? If False, solid solutions are ignored.
    
    clear_es_solids_read : bool, default False
        Clear the ES solids read from the input file?
    
    clear_es_solids_initial : bool, default False
        Clear the ES solids at the initial value of reaction progress?
    
    clear_es_solids_end : bool, default False
        Clear the ES solids at the end of the run?
    
    clear_prs_solids_read : bool, default False
        Clear the PRS solids read from the input file?
    
    clear_prs_solids_end : bool, default False
        Clear the PRS solids at the end of the run? If True, PRS solids will
        be cleared unless numerical problems cause early termination.
    
    auto_basis_switching_pre_NR : bool, default False
        Turn on auto basis switching in pre-Newton-Raphson optimization?
    
    auto_basis_switching_post_NR : bool, default False
        Turn on auto basis switching after Newton-Raphson iteration?
    
    calc_mode_selection : int, default 0
        Calculational mode selection. Valid options include:
        
        - 0 for normal path tracing
        - 1 for economy mode (if permissible)
        - 2 for super economy mode (if permissible)
    
    ODE_corrector_mode : int, default 0
        ODE integrator corrector mode selection. Valid options include:
        
        - 0 to allow stiff and simple correctors
        - 1 to allow only simple corrector
        - 2 to allow only stiff corrector
        - 3 to allow no correctors
    
    mineral_suppression_option : str, default "None"
        Option to suppress formation of minerals. Can be either "None" (no
        minerals are suppressed) or "All" (all minerals are suppressed).
    
    write_tab : int, default -1
        Option to write a TAB file. Valid options include:
        
        - -1 do not write a TAB file (default)
        - 0 write a TAB file
        - 1 write a TAB file prepending TABX file data from a previous run
    
    fluid_mixing_setup : bool, default False
        If True, will write an EQ6 input file with Fluid 1 set up for
        fluid mixing. If False, a normal EQ6 pickup file will be written.
     
    max_finite_difference_order : int, default 6
        Maximum finite-difference order (numerical parameter).
     
    beta_convergence_tolerance : float, default 0
        Beta convergence tolerance (numerical parameter).
     
    del_convergence_tolerance : float, default 0
        Delta convergence tolerance (numerical parameter).
     
    max_n_NR_iter : int, default 500
        Maximum number of N-R iterations (numerical parameter).
     
    search_find_convergeance_tolerance : float, default 0
        Search/find convergence tolerance (numerical parameter).
     
    saturation_tolerance : float, default 0
        Saturation tolerance (numerical parameter).
     
    max_n_phase_assemblage_tries : int, default 0
        Maximum number of phase assemblage tries (numerical parameter).
     
    zero_order_step_size : int, default 0
        Zero order step size in Xi (numerical parameter).
     
    max_interval_in_xi_between_PRS_transfers : int, default 0
        Maximum interval in Xi between PRS transfers (numerical parameter).
     
    filename : str, default None
        Filename where the results of `Prepare_Reaction` will be written.
        This is equivalent to the top half of an EQ3/6 6i file. If None,
        no file will be written.
         
    hide_traceback : bool, default True
        Hide traceback message when encountering errors handled by this
        class? When True, error messages handled by this class will be short
        and to the point.

`Reactant(reactant_name, reactant_type='Pure mineral', reactant_status='Reacting', amount_remaining=1, amount_destroyed=0, molar_volume=0, surface_area_option=0, surface_area_value=0, surface_area_factor=0, f_rate_law='Relative rate equation', f_eq1=1, f_eq2=0, f_eq3=0, b_rate_law='Partial equilibrium', b_eq1=1, b_eq2=0, b_eq3=0, special_reactant_dict={}, hide_traceback=True)`
:   Class used to define reactants for `Prepare_Reaction`.
    
    Parameters
    ----------
    reactant_name : str
        Name of the reactant.
    
    reactant_type : str, default "Pure mineral"
        Reactant type. Valid types include:
        
        - Pure mineral
        - Solid solution
        - Special reactant
        - Aqueous species
        - Gas species
        - Generic ion exchanger
    
    reactant_status : str, default "Reacting"
        Status of the reactant. Valid statuses include:
        
        - Reacting
        - Saturated, reacting
        - Exhausted
        - Saturated, not reacting
    
    amount_remaining : float, default 1
        Moles of reactant remaining.
    
    amount_destroyed : float, default 0
        Moles of reactant destroyed.
    
    surface_area_option : int, default 0
        Option for reactant surface area. Valid options include:
        
        - 0, for Constant surface area (in cm2)
        - 1, for Constant specific surface area (in cm2/g). Surface area
        changes in proportion to the reactant mass.
        - 2, for n**2/3 growth law- current surface area (in cm2)
    
    surface_area_value : float, default 0
        The value assigned to choice of surface area option according to:
        
        - If `surface_area_option` is 0, value is in cm2.
        - If `surface_area_option` is 1, value is in cm2/g.
        - If `surface_area_option` is 2, value is in cm2.
    
    surface_area_factor : float, default 0
        Value assigned to surface area factor.
    
    f_rate_law : str, default "Relative rate equation"
        Type of forward rate law. Valid types include:
        
        - Use backward rate law
        - Relative rate equation
        The TST rate equation is not yet supported.
    
    f_eq1, f_eq2, f_eq3 : float, default 1, 0, 0, respectively
        Coefficients of the forward rate law defined for `f_rate_law`.
        If `f_rate_law` is "Relative rate equation", then:
        
        - f_eq1 is dXi(n)/dXi (mol/mol)
        - f_eq2 is d2Xi(n)/dXi2 (mol/mol2)
        - f_eq3 is d3Xi(n)/dXi3 (mol/mol3)
    
    b_rate_law : str, default "Partial equilibrium"
        Type of backward rate law. Valid types include:
        
        - Use forward rate law
        - Partial equilibrium
        - Relative rate equation
        The TST rate equation is not yet supported.
        
    b_eq1, b_eq2, b_eq3 : float, default 1, 0, 0, respectively
        Coefficients of the backward rate law defined for `b_rate_law`.
        If `b_rate_law` is "Relative rate equation", then:
        
        - the value of b_eq1 represents dXi(n)/dXi (mol/mol)
        - the value of b_eq2 represents d2Xi(n)/dXi2 (mol/mol2)
        - the value of b_eq3 represents d3Xi(n)/dXi3 (mol/mol3)
    
    hide_traceback : bool, default True
        Hide traceback message when encountering errors handled by this class?
        When True, error messages handled by this class will be short and to
        the point.